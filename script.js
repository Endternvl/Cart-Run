maps = [
    [ 
      '. . . . . t . . . . .'.split(' '),
      '. . . . . . . . . . .'.split(' '),
      'c . . . . . . . . . t'.split(' '),
      '. . . . . . . . . . .'.split(' '),
      '. . . . . t . . . . .'.split(' ')
    ],
    [  
      'w . . . . . . . w . t'.split(' '),
      'w . w w w w w . w . w'.split(' '),
      'w . . . . . w . w . w'.split(' '),
      'w w w w w . w . w . w'.split(' '),
      'c . . . . . w . . . w'.split(' ')
    ],
    [
      '. . . . . t . . . . .'.split(' '),
      '. w . w . w . w . w .'.split(' '),
      '. w . w p w p w . w .'.split(' '),
      '. w . w . w . w . w .'.split(' '),
      'c . . . . . . . . . .'.split(' ')
    ],
    [ 
      'p . . . . . . . . . p'.split(' '),
      '. w w . w w w . w w .'.split(' '),
      '. . . . p t p . . . .'.split(' '),
      '. w w . w w w . w w .'.split(' '),
      '. . . . . c . . . . .'.split(' ')
    ],
    [ 
      '. w . . . w . . . w .'.split(' '),
      '. w . w . w . w . w .'.split(' '),
      't p . w . p . w p . c'.split(' '),
      '. w . w . w . w . w .'.split(' '),
      '. w . . . w . . . w .'.split(' ')
    ],
    [ 
      's . . . . p . . . . .'.split(' '),
      '. w w . w w w . w w .'.split(' '),
      '. . . . i t . . . . .'.split(' '),
      '. w w . w w w . w w .'.split(' '),
      '. . . c . . . . . . .'.split(' ')
    ],
    [ 
      '. p . . . t . . . p .'.split(' '),
      '. w . w . w . w . w .'.split(' '),
      '. w . w i w i w . w .'.split(' '),
      '. w . w . w . w . w .'.split(' '),
      'c . . . . s . . . . .'.split(' ')
    ],
    [ 
      't w . p . w . i . w .'.split(' '),
      '. w . w . w . w . w .'.split(' '),
      '. . i w i s . w . s c'.split(' '),
      '. w . w . w . w . w .'.split(' '),
      'p w . i . w . . . w .'.split(' ')
    ],
    [ 
      '. . . . . t . . . . .'.split(' '),
      '. . . . . . . . . . .'.split(' '),
      'f . . . . . . . . . f'.split(' '),
      '. . . . . . . . . . .'.split(' '),
      '. . . . . c . . . . e'.split(' ')
    ],
    [ 
      '. . . e . . . . . . .'.split(' '),
      '. w . w . w . w . w .'.split(' '),
      '. w . w i w f w . w t'.split(' '),
      '. w . w . w . w . w .'.split(' '),
      'c . . s . . . . . . .'.split(' ')
    ],
    [ 
      'f . . . . . . . . . f'.split(' '),
      '. w w . w w w . w w .'.split(' '),
      'p . . i . t . i . . p'.split(' '),
      '. w w . w w w . w w .'.split(' '),
      's . . . . c e . . . s'.split(' ')
    ],
    [ 
      '. . . . . . . . . . .'.split(' '),
      'w w w w w w w w w w w'.split(' '),
      'c . . . . k . . . v t'.split(' '),
      'w w w w w w w w w w w'.split(' '),
      '. . . . . . . . . . .'.split(' ')
    ],
    [ 
      't w w w w w w w w w w'.split(' '),
      '. . . v . . . . . . w'.split(' '),
      'w w w p w w w w w . w'.split(' '),
      'w w w . w w w w w v w'.split(' '),
      'c . . . . k . . . . w'.split(' ')
    ],
    [ 
      't w . . . . . . . . c'.split(' '),
      'v w . . . . . . . . .'.split(' '),
      '. . . . . k . . . . .'.split(' '),
      '. . . . . . . . . . .'.split(' '),
      '. . . . . . . g . . .'.split(' ')
    ],
    [ 
      't w . . . . . . . . c'.split(' '),
      'v w . g . . . . . . .'.split(' '),
      '. . . . . k . . . . .'.split(' '),
      '. g . . . . . . . . .'.split(' '),
      '. . . . . . . . . . .'.split(' ')
    ],
    [ 
      'k . . . . . . . . . .'.split(' '),
      '. . . . p w g . . . .'.split(' '),
      '. . . . w t v . . . .'.split(' '),
      '. . . . g w p . . . .'.split(' '),
      '. . . . . . . . . . c'.split(' ')
    ],
    [ 
      'k . . p . . i . . . f'.split(' '),
      '. . . . . . . . . . .'.split(' '),
      '. . . . . . . . . . .'.split(' '),
      'v w . w w w w . . . .'.split(' '),
      't w g v s e w c . . .'.split(' ')
    ],
    [ 
      'p p p p p p p p p p p'.split(' '),
      'v . . . . . . . . . w'.split(' '),
      't v . . . k . . f e c'.split(' '),
      'v . . . . . . . . . w'.split(' '),
      'p p p p p p p p p p p'.split(' ')
    ],
    [ 
      'p . p . p . p . p . p'.split(' '),
      'v . . . . . . . . . .'.split(' '),
      't v . . . k . . . . c'.split(' '),
      'v . . . . . . . . . .'.split(' '),
      'p . p . p . p . p . p'.split(' ')
    ],
    [ 
      'k . . . . p . . . . i'.split(' '),
      'v . . . . w . . . . .'.split(' '),
      't v . . v t w . . . c'.split(' '),
      'v . . . . w . . . . w'.split(' '),
      'g . . . . g . . . w s'.split(' ')
    ],
    [ 
      '. . . . w p v . . k .'.split(' '),
      '. . . . w p w . . . .'.split(' '),
      '. . . . w p w . . - .'.split(' '),
      '. . . . w p w . . . .'.split(' '),
      '. . . . w t w . . c .'.split(' ')
    ],
    [ 
      'p v g . . . . . w w w'.split(' '),
      '. w . . . w . . . . c'.split(' '),
      '. w . . . k w . . . -'.split(' '),
      '. w . . . w . . . . .'.split(' '),
      't w g . . . . . w w w'.split(' ')
    ],
    [ 
      'g . . . . . . . p . .'.split(' '),
      '. . . . . . . . . . .'.split(' '),
      't . . . p . p . - . c'.split(' '),
      '. . . . . . . . . . .'.split(' '),
      'g . . . . . . . p . .'.split(' ')
    ],
    [ 
      'g . . . . . . . . . g'.split(' '),
      'v . . . . . . . . g -'.split(' '),
      't v . . k . . g - . c'.split(' '),
      'v . . . . . . . . . -'.split(' '),
      'g . . . . . . . - - g'.split(' ')
    ],
    [
      '. . . . . g . . . . .'.split(' '),
      '. w . w . w . w . w .'.split(' '),
      '- w p w p w p w p w t'.split(' '),
      '. w . w . w . w . w .'.split(' '),
      'c . . . . g . . . . .'.split(' ')
    ],
    [ 
      'p . . . . . . . . . p'.split(' '),
      '. w w . w w w . w w .'.split(' '),
      'k . . . g t g . . . -'.split(' '),
      '. w w . w v w . w w .'.split(' '),
      '. . . . . c . . . . .'.split(' ')
    ],
    [ 
      't w . . . w . . . w k'.split(' '),
      '. w . w . w . w . w .'.split(' '),
      '. p . v . p . v p . c'.split(' '),
      '. w . w . w . w . w .'.split(' '),
      'g w . . . w . . . w -'.split(' ')
    ],
    [ 
      's . . . . p . . . . p'.split(' '),
      '. w w . w w w . w w .'.split(' '),
      '. . . . g t i . . . .'.split(' '),
      '. w w . w w w . w w .'.split(' '),
      '. . . c . . . . g . -'.split(' ')
    ],
    [ 
      '. g w . p v p . w g .'.split(' '),
      '. w w . w w w g w w .'.split(' '),
      '. . . . v t v . k - c'.split(' '),
      '. w w . w w w g w w .'.split(' '),
      '. g w . . v . . w g .'.split(' ')
    ],
    [ 
      '. g w . w t w . w p e'.split(' '),
      '. w w - w p w g w w .'.split(' '),
      'v v v v w v w v v v v'.split(' '),
      'p . . . p f . f p . k'.split(' '),
      '. . p . . . p . . . c'.split(' ')
    ],
    [  
      'w . . . . . . . w . t'.split(' '),
      'w . w w w w w . w . w'.split(' '),
      'w . . . d . w . w . w'.split(' '),
      'w w w w w . w . w . w'.split(' '),
      'c . . . . . w . . . w'.split(' ')
    ],
    [  
      'w w w w w w w w w w w'.split(' '),
      'w c d . p . . . . . w'.split(' '),
      'w . . . . . p . . . w'.split(' '),
      'w . p . . . . . . t w'.split(' '),
      'w w w w w w w w w w w'.split(' ')
    ],
    [  
      '. . . . . . . . . . .'.split(' '),
      'w w w w w w w w w w w'.split(' '),
      'w g c k d . . . v t w'.split(' '),
      'w w w w w w w w w w w'.split(' '),
      '. . . . . . . . . . .'.split(' ')
    ],
    [  
      'c d . . . . . . - . e'.split(' '),
      '. . . . . . . . . . .'.split(' '),
      'p . p . p . p . p . p'.split(' '),
      'g . . . . . . . . . .'.split(' '),
      't g . . . . . . . . f'.split(' ')
    ],
    [  
      'c . . . . d . . . . .'.split(' '),
      'w w w w w w w w w w .'.split(' '),
      '. . . . . e . . . . .'.split(' '),
      '. w w w w w w w w w w'.split(' '),
      '. . . . . f . . . . t'.split(' ')
    ],
    [  
      'c . . . . d . . . . d'.split(' '),
      'w w w w w w w w w w .'.split(' '),
      '. . . . . e . . . . .'.split(' '),
      '. w w w w w w w w w w'.split(' '),
      '. . . . . . f . . . t'.split(' ')
    ],
    [  
      'w ~ . . . . . ~ w . t'.split(' '),
      'w . w w w w w . w . w'.split(' '),
      'w . . . ~ . w . w ~ w'.split(' '),
      'w w w w w . w . w . w'.split(' '),
      'c . . . . . w ~ . . w'.split(' ')
    ],
    [  
      'w ~ . ~ . ~ . d w . t'.split(' '),
      'w . w w w w w d w d w'.split(' '),
      'w ~ . ~ . d w d w d w'.split(' '),
      'w w w w w . w . w d w'.split(' '),
      'c d . d . d w ~ ~ ~ w'.split(' ')
    ],
    [
      '. . . ~ . t . ~ . . .'.split(' '),
      '. w . w . w . w . w .'.split(' '),
      '. w . w p w p w . w .'.split(' '),
      '. w . w . w . w . w .'.split(' '),
      'c . . ~ . p . ~ . . .'.split(' ')
    ],
    [
      'w i w . w . w . w g w'.split(' '),
      '. . . . . ~ . . ~ . v'.split(' '),
      'c w s w k w d w d w t'.split(' '),
      '. . . . . ~ . . ~ . v'.split(' '),
      'w . w . w . w . w g w'.split(' ')
    ],
    [
      't = t = t = t = t = t'.split(' '),
      '= = = = = = = = = = ='.split(' '),
      't = = = = c = = = = t'.split(' '),
      '= = = = = = = = = = ='.split(' '),
      't = t = t = t = t = t'.split(' ')
    ],
    [
      't . . . . . . . . . .'.split(' '),
      'w w w = w w = w w w w'.split(' '),
      '. . . . . c . . . . .'.split(' '),
      'w = w w w w w w = w w'.split(' '),
      '. . . . . . . . . . t'.split(' ')
    ],
    [
      '. . w . w . = . = . .'.split(' '),
      '. . w . = . = . w . .'.split(' '),
      'c . = . w . = . = . t'.split(' '),
      '. . w . w . w . w . .'.split(' '),
      '. . = . = . w . = . .'.split(' ')
    ],
    [
      'g = . . v t v . . = g'.split(' '),
      'g = . . v v v . . = g'.split(' '),
      'g = . . . . . . . = g'.split(' '),
      'g = . . . . . . . = g'.split(' '),
      'g = . k w c w k . = g'.split(' ')
    ],
    [
      '. . e . . i . . ~ v t'.split(' '),
      '. . . . . w . . . . ='.split(' '),
      'c . d . . = . . . . .'.split(' '),
      '. . . . . w . k . w ='.split(' '),
      '. . s . . f . . . . g'.split(' ')
    ],
    [
      '. . . . . = . . . . .'.split(' '),
      '. . . . . w . . . . .'.split(' '),
      'c . x . . = . . . . t'.split(' '),
      '. . . . . = . . . . .'.split(' '),
      '. . . . . w . . . . .'.split(' ')
    ],
    [
      'x w w = = = = w = = ='.split(' '),
      '. w w = w w = = = w ='.split(' '),
      'c w w = w w w w w w ='.split(' '),
      '. w = = w t = = = w ='.split(' '),
      '. = = w w w w w = = ='.split(' ')
    ],
    [
      'x v k . = g g g . w t'.split(' '),
      'v v . . = = = = . w .'.split(' '),
      '. . . . . . . . . = .'.split(' '),
      '. . p . = = = = . w .'.split(' '),
      'c . . . = g g g . v .'.split(' ')
    ],
    [
      'i = g w i = g w . v t'.split(' '),
      '= = w w = = w w = w w'.split(' '),
      '. . . . . . . . . . .'.split(' '),
      '. . . . w = w w . . .'.split(' '),
      'k . f . w s e w . x c'.split(' ')
    ],
    [ 
      'p v . . . . . . w w w'.split(' '),
      't w g . . w ~ . . d c'.split(' '),
      'g w . . = k v ~ . . -'.split(' '),
      'k w g . . w ~ . . . .'.split(' '),
      'p = . . . . . p w w w'.split(' ')
    ],
    []
  ]
  
  descs = [
    "Covid-19 has hit again with the 380th wave. Deadlier than ever. The entire world is in full quarantine. However, you are out of toilet paper! In order to escape from this deadly situation, you must get out of your house... Hooray! Here's an empty store with three rolls! Grab them all!",
    "Another one! But don't run into the walls. Man, who designed this layout?",
    "Wait! You're not alone! You have to social distance from these other people, otherwise you might catch covid! And thank goodness they aren't looking for the toilet paper, they won't take it.",
    "Wow, look at all these people not following the governmental guidelines. Hehehehehe :)",
    "More people. And I'm on the opposite side of this badly designed store!",
    "Uh no! An infected person! Keep clear of them! Make sure not to walk into the contaminated areas as well... Unless - you have soap! Use the soap to walk over the covid. It doesn't stand a chance. In addition, the person's entire body seems to be made of covid. Weird? Anyways, if you have soap they'll avoid you, and you can kill them if you have the soap as well. Just walk onto them with your soapy fingers.",
    "Look! The covid virus is spreading! Two infected people. Remember, the other people have already applied soap. They're safe from the infected person.",
    "What's up with these store layouts? And watch out for these infected people! They are extra-powerful. You need both bars of soap to surive.",
    "Oh no! One person was denied access to the toilet paper! They've set fire to the store! I quote, 'If I don't get it, nobody does!' Luckily there's a handy fire extinguisher you can use (if you need it). Watch out though, you have to get the toilet paper before it burns in the fire!",
    "Woof, this is dangerous. You've got a fire and infected person. If you're smart, you might be able to use the fire to help. It will burn covid! And thank goodness this fire is nice, it won't burn the fire extinguisher before you can get it.",
    "This one is difficult. Two fires, two infected people, two normal people. And since there's two pieces of soap, you have to grab them both to save your life. Also, this friendly fire won't burn the soap! :)",
    "Here is where our life get's interesting. The store owner has locked the toilet paper deep in a vault. You'll have to nab the key before you can open it, otherwise you'll crash.",
    "A double vault! They're getting paranoid! (Or not, it doesn't count as paranoia if it actually happens). But don't worry, these people left the key on the floor.",
    "Oh no! The store owners have hired a guard, and man are they fast. If you grab the key, they'll start running around. And if you're close enough, they'll jump on you and imprison you. Otherwise they'll stand by peacefully as you shop (and break the quarantine law. Weird, right?).",
    "Double guards! Let's see if you can make it past them this time. Tip: Retreat after grabbing the key, and wait for the guards to move past the entrance to the vault.",
    "Two guards, two people. And you'll have to cross the map to the opposite corner, and make it back to the opposite side. This requires patience and timing.",
    "Don't be fooled into thinking you need something just because it's there.",
    "In case you wanted to know, that's 22 people. And fire doesn't burn keys as well.",
    "Time to test your agility (but I've completed this one just by going straight). Also, I have to congratulate you on your brains for that previous level. Keep using that intelligence.",
    "That person at the top!!! Right? Timing, timing, timing.",
    "Are these people annoying you? Pick up a gun to kill them if they get in your way!",
    "These guards are well-trained. Good luck. :) PS: Gaurds don't like it when you pick up guns. (And you can't kill them with it)",
    "Grab the gun quick! But wait, the cops will move!",
    "Don't fall for the temptation.",
    "Use those guys as human shields from the guards.",
    "Which do you choose? You might not live past grabbing the first one.",
    "Argh! The Guard! (Hmm that rhymes maybe I should write a poem).",
    "Not as complicated as you might think? But you will need to plan some steps.",
    "So many guards. Time to tempt fate.",
    "I call this 'The Fortress'. Idk why :|. Anywyas, getting toilet paper is more complicated these days.",
    "Man this store is stocked. Check out this tasty energy drink. Garunteed to boost your speed.",
    "Why does this one have thick walls? Makes less space to move. You might need a boost to help avoid those people.",
    "Try to use one to avoid a guard! They're still plenty fast!",
    "You have to distract those guards! And by the way, they don't burn in fire. Nice try :)",
    "Race - You + Turbo vs Fire. Why did that person light it so close to the toilet paper?",
    "Race 2.0 - They lit it even closer! Luckily there are two handy energy drinks. Grab them both to gain even more speed. You'll need it.",
    "The janitor hasn't been on duty... Avoid the slippery floor if you can. Otherwise, you'll injure yourself and slow down.",
    "An energy drink overdose can be dangerous! Luckily (?), you can injure yourself and slow down.",
    "These other people care about their well being, they won't walk onto slippery floors.",
    "Got to fix these blueprints... The guards won't walk onto slippery floors either. They're surprisingly scared of them.",
    "What's this? Looks impossible? Think again! These stores have upgraded technology! They're getting desperate to keep the toilet paper hidden.",
    "Secret passageways... Indistiguishable from the real walls. You'll just have to guess and hope your right.",
    "Here's another. You've got to remember where they are, huh? Unless you're lucky or an amazing guesser, or a hacker who looked at the code and a CHEATER!",
    "Two keys? Don't worry you only need one. It's for a symmetrical effect. And what are those guards doing?",
    "'You didn't tell me guards could go through secret passageways!' Muahahahaha. Some levels will be possible with or without the passageways.",
    "Look what's that on the floor? INTRODUCING THE ALL NEW X-RAY GOGGLES! Garunteed to show you where those hidden secret passageways are. A great tool to help you rob toilet paper from stores. Find it right in this store. Isn't it ironic how they keep helping you steel their own stuff?",
    "Good luck trying to complete this one without grabbing those goggles. You'd need patience and a piece of paper to draw a map.",
    "Nothing too special-looking about this store. Let's see if they have anything hidden though...",
    "I call this, the 'Fortress II'.",
    "Another remake of a hard level. Some people will never find it, but still succeed.",
    `You've completed the game of Grocery Run <br>
    I hope you think 'twas a lot of fun <br>
    You're now a world-class professional shopper <br>
    On a dangerous quest for some toilet paper <br>
    You remained social-distanced and washed your hands with soap <br>
    Such a grueling task, I'm surprised you could cope! <br>
    Many infected people left little covid trails <br>
    You survived by washing your hands and nails <br>
    Arsonists gave you a gift of fire <br>
    And yet, my friend, you did not tire! <br>
    And when they locked it up in a vault <br>
    Desperately trying to get you to halt <br>
    You angered the owner as you discovered the key <br>
    'We must stop this and hire some guards', said he <br>
    You used your keen mind and your intellect <br>
    Though 'twas in a way your mother wouldn't accept <br>
    You found out that the store, in stock, had a gun <br>
    And you remained nice, tried to only kill one <br>
    You looked at the aisles, and then you did think <br>
    To make me move faster, I'll grab an energy drink! <br>
    You did your best to avoid the slippery floor <br>
    In order to escape fast through the door <br>
    You explored and found a secret passageway <br>
    Forgotten long ago, when the builder passed away <br>
    You used nearby resources, an x-ray goggle <br>
    'How does he know?!' You made the guards boggle <br>
    I hope the game became an obsession <br>
    And for playing to the end, you have my appreciation <br>
  
    &copy; Pyer Poetry 2021`
  ]
  
  let currmap = []
  let currlev = 0
  let speed = .5
  let pspeed = 1000
  let direction = '';
  let tpleft = 0;
  let tpgrab = 0;
  let hasstarted = false
  let hasgun = false
  let haskey = false
  let hasgog = false
  let cmoveint = function(){}
  let pmoveint = function(){}
  let imoveint = function(){}
  let fmoveint = function(){}
  let gmoveint = function(){}
  
  function updatetable(ls){
    var tr = 5
    var td = 11;
      var table = "<table cellspacing='0'>";
      for(i = 0; i < tr; i++) {
          table += "<tr>";
          for(j = 0; j < td; j++) {
              if (ls[i][j]==='c'){
          table += "<td class='cart'>üõí</td>";
        }else if(ls[i][j]==='p'){
          table += "<td class='person'>üë®</td>";
        }else if(ls[i][j]==='w'){
          table += "<td class='wall'>üß±</td>";
        }else if(ls[i][j]==='t'){
          table += "<td class='toiletpaper'>üßª</td>"
        }else if(ls[i][j]==='.'){
          table += "<td class='empty'>&nbsp;</td>"
        }else if(ls[i][j]=='*'){
          table += "<td class='collision'>üí•</td>"
        }else if(ls[i][j]=='i'){
          table += "<td class='infector'>ü§¢</td>"
        }else if(ls[i][j]=='#'){
          table += "<td class='sick'>ü¶†</td>"
        }else if(ls[i][j]=='s'){
          table += "<td class='sanitizer'>üßº</td>"
        }else if(ls[i][j]=='f'){
          table += "<td class='fire'>üî•</td>"
        }else if(ls[i][j]=='e'){
          table += "<td class='fireextinguisher'>üßØ</td>"
        }else if(ls[i][j]=='k'){
          table += "<td class='key'>üîë</td>"
        }else if(ls[i][j]=='v'){
          table += "<td class='vault'>üö™</td>"
        }else if(ls[i][j]=='g'){
          table += "<td class='vault'>üëÆ</td>"
        }else if(ls[i][j]=='-'){
          table += "<td class='gun'>üî´</td>"
        }else if(ls[i][j]=='d'){
          table += "<td class='drink'>ü•§</td>"
        }else if(ls[i][j]=='~'){
          table += "<td class='water'>Ô∏è‚ö†Ô∏è</td>"
        }else if(ls[i][j]=='='){
          if(!hasgog){
            table += "<td class='secretpassageway'>üß±</td>"
          }else{
            table += "<td class='secretpassageway'>üî≤</td>"
          }
        }else if(ls[i][j]=='x'){
          table += "<td class='xraygoggles'>ü•Ω</td>"
        }
          }
          table += "</tr>";
      }
      table += "</table>";
      document.getElementById("table").innerHTML = table;
    if((!(countpaper()))&&(!(tpgrab==tpleft))) {
      gameover()
    }else if(!countpaper()){
      nextlevel()
    }
  }
  
  function nextlevel() {
    currlev++
    if(!(currlev==maps.length)){
      clearInterval(cmoveint)
      clearInterval(pmoveint)
      clearInterval(imoveint)
      clearInterval(fmoveint)
      clearInterval(gmoveint)
      hasstarted = false;
      direction = '';
      hasgun = false;
      haskey = false;
      hasgog = false;
      pspeed = 1000;
      loadmap(currlev)
    }else{
      overlay('Complete!', 'You are a professional shopper now!')
    }
  }
  
  function gameover() {
    clearInterval(cmoveint)
    clearInterval(pmoveint)
    clearInterval(imoveint)
    clearInterval(fmoveint)
    clearInterval(gmoveint)
    hasstarted = false;
    direction = '';
    hasgun = false;
    haskey = false;
    hasgog = false;
    pspeed = 1000;
    loadmap(currlev)
  }
  
  function removeoverlay(){
    document.getElementById("table").style.backgroundColor = '#22222211'
    updatetable(currmap)
  }
  
  function overlay(header, text){
    document.getElementById("table").style.backgroundColor = '#222222CC'
    var tag1 = document.createElement("h1");
    var cont1 = document.createTextNode(header);
    tag1.appendChild(cont1);
  
    var tag2 = document.createElement("p");
    var cont2 = document.createTextNode(text);
    tag2.appendChild(cont2);
  
    var element = document.getElementById("table");
    element.appendChild(tag1);
    element.appendChild(tag2);
  }
  
  function updatedesc(lvl){
    document.getElementById("instructions").innerHTML = descs[lvl];
  }
  
  function loadmap(level){
    updatedesc(level)
    if(!(level==maps.length-1)){
      m = maps[level]
      currmap = JSON.parse(JSON.stringify(m))
      updatetable(m)
      direction = '';
      tpleft = countpaper()
      tpgrab = 0
      hasgun = false;
      haskey = false;
      hasgog = false;
      pspeed = 1000;
      overlay('Level ' + (level+1).toString(), 'Press Any Key To Start')
    }else{
      console.log('complete')
      document.getElementById("table").innerHTML = '<h1 id="comp">Complete!</div>';
    }
  }
  
  function ldmp(level){
    m = maps[level]
    currmap = JSON.parse(JSON.stringify(m))
  }
  
  function getplayercoords() {
    for(i = 0; i < 5; i++) {
      if(currmap[i].indexOf('c')>-1){ 
        return [i, currmap[i].indexOf('c')]
      }
    }
  }
  
  function getinfectcoords() {
    coords = []
    for(i = 0; i < 5; i++) {
      for(j=0; j < 11; j++) {
        if(currmap[i][j]=='i'){
          coords.push([i, j])      
        }
      }
    }
    return coords
  }
  
  function getguardcoords() {
    coords = []
    for(i = 0; i < 5; i++) {
      for(j=0; j < 11; j++) {
        if(currmap[i][j]=='g'){
          coords.push([i, j])      
        }
      }
    }
    return coords
  }
  
  function getfirecoords() {
    coords = []
    for(i = 0; i < 5; i++) {
      for(j=0; j < 11; j++) {
        if(currmap[i][j]=='f'){
          coords.push([i, j])      
        }
      }
    }
    return coords
  }
  
  function hassantizer(){
    for(i = 0; i < 5; i++) {
      if(currmap[i].indexOf('s')>-1){ 
        return false
      }
    }
    return true
  }
  
  function hasexting(){
    for(i = 0; i < 5; i++) {
      if(currmap[i].indexOf('e')>-1){ 
        return false
      }
    }
    return true
  }
  
  function countpaper() {
    c = 0
    for(i = 0; i < 5; i++) {
      for(j=0; j < 11; j++) {
        if(currmap[i][j]=='t'){
          c++   
        }
      }
    }
    return c
  }
  
  function moveplayer() {
    c = getplayercoords()
    if(!c) {
      gameover()
      return
    }
    n =  JSON.parse(JSON.stringify(c))
    d = direction
    if(d=='w') { if(c[0]-1<0){ return } else { n[0]-- } }
    if(d=='s') { if(c[0]+1>4){ return } else { n[0]++ } }
    if(d=='a') { if(c[1]-1<0){ return } else { n[1]-- } }
    if(d=='d') { if(c[1]+1>10){ return } else { n[1]++ } }
    currmap[c[0]][c[1]] = '.'
    if(currmap[n[0]][n[1]]=='p'){
      if(!hasgun){
        currmap[n[0]][n[1]] = '!'
        gameover()
        return
      }
    }else if(currmap[n[0]][n[1]]=='w'){
      currmap[n[0]][n[1]] = '*'
      gameover()
      return
    }else if((currmap[n[0]][n[1]]=='f')&&(!hasexting())){
      currmap[n[0]][n[1]] = 'f'
      gameover()
      return
    }else if((currmap[n[0]][n[1]]=='i')&&(!hassantizer())){
      currmap[n[0]][n[1]] = '!'
      gameover()
      return
    }else if((currmap[n[0]][n[1]]=='#')&&(!hassantizer())){
      currmap[n[0]][n[1]] = '!'
      gameover()
      return
    }else if((currmap[n[0]][n[1]]=='v')&&(!haskey)){
      currmap[n[0]][n[1]] = '!'
      gameover()
      return
    }else if((currmap[n[0]][n[1]]=='g')){
      currmap[n[0]][n[1]] = '!'
      gameover()
      return
    }else if((currmap[n[0]][n[1]]=='-')){
      hasgun = true
    }else if((currmap[n[0]][n[1]]=='k')){
      haskey = true
    }else if((currmap[n[0]][n[1]]=='t')){
      tpgrab++
    }else if((currmap[n[0]][n[1]]=='d')){
      pspeed = pspeed/1.45;
      clearInterval(cmoveint)
      cmoveint = setInterval(moveplayer, pspeed*speed)
    }else if((currmap[n[0]][n[1]]=='~')){
      pspeed = pspeed*1.25;
      clearInterval(cmoveint)
      cmoveint = setInterval(moveplayer, pspeed*speed)
    }else if((currmap[n[0]][n[1]]=='x')){
      hasgog = true
    }
    currmap[n[0]][n[1]] = 'c'
    updatetable(currmap)
  }
  
  function getpeoplecoords() {
    coords = []
    for(i = 0; i < 5; i++) {
      for(j=0; j < 11; j++) {
        if(currmap[i][j]=='p'){
          coords.push([i, j])      
        }
      }
    }
    return coords
  }
  
  function movepeople() {
    c = getpeoplecoords()
    c.forEach(function(i){
      n = JSON.parse(JSON.stringify(i))
      hasmoved = false
      while(!hasmoved){
        d = Math.ceil(Math.random()*4)
        if(d==1) { 
          if(!(i[0]-1<0)) {
            n[0]--
            if((!(currmap[n[0]][n[1]]=='p'))&&(!(currmap[n[0]][n[1]]=='w'))&&(!(currmap[n[0]][n[1]]=='t'))&&(!(currmap[n[0]][n[1]]=='i'))&&(!(currmap[n[0]][n[1]]=='e'))&&(!(currmap[n[0]][n[1]]=='s'))&&(!(currmap[n[0]][n[1]]=='v'))&&(!(currmap[n[0]][n[1]]=='k'))&&(!(currmap[n[0]][n[1]]=='g'))&&(!(currmap[n[0]][n[1]]=='f'))&&(!((currmap[n[0]][n[1]]=='c')&&hasgun))&&(!(currmap[n[0]][n[1]]=='~'))&&(!(currmap[n[0]][n[1]]=='='))){
              currmap[i[0]][i[1]] = '.'
              currmap[n[0]][n[1]] = 'p'
              hasmoved = true;
            }
            n[0]++
          }
        }
        if(d==2) { 
          if(!(i[0]+1>4)) {
            n[0]++
            if((!(currmap[n[0]][n[1]]=='p'))&&(!(currmap[n[0]][n[1]]=='w'))&&(!(currmap[n[0]][n[1]]=='t'))&&(!(currmap[n[0]][n[1]]=='i'))&&(!(currmap[n[0]][n[1]]=='e'))&&(!(currmap[n[0]][n[1]]=='s'))&&(!(currmap[n[0]][n[1]]=='v'))&&(!(currmap[n[0]][n[1]]=='k'))&&(!(currmap[n[0]][n[1]]=='g'))&&(!(currmap[n[0]][n[1]]=='f'))&&(!((currmap[n[0]][n[1]]=='c')&&hasgun))&&(!(currmap[n[0]][n[1]]=='~'))&&(!(currmap[n[0]][n[1]]=='='))){
              currmap[i[0]][i[1]] = '.'
              currmap[n[0]][n[1]] = 'p'
              hasmoved = true;
            }
            n[0]--
          }
        }
        if(d==3) { 
          if(!(i[1]-1<0)) {
            n[1]--
            if((!(currmap[n[0]][n[1]]=='p'))&&(!(currmap[n[0]][n[1]]=='w'))&&(!(currmap[n[0]][n[1]]=='t'))&&(!(currmap[n[0]][n[1]]=='i'))&&(!(currmap[n[0]][n[1]]=='e'))&&(!(currmap[n[0]][n[1]]=='s'))&&(!(currmap[n[0]][n[1]]=='v'))&&(!(currmap[n[0]][n[1]]=='k'))&&(!(currmap[n[0]][n[1]]=='g'))&&(!(currmap[n[0]][n[1]]=='f'))&&(!((currmap[n[0]][n[1]]=='c')&&hasgun))&&(!(currmap[n[0]][n[1]]=='~'))&&(!(currmap[n[0]][n[1]]=='='))){
              currmap[i[0]][i[1]] = '.'
              currmap[n[0]][n[1]] = 'p'
              hasmoved = true;
            }
            n[1]++
          }
        }
        if(d==4) { 
          if(!(i[1]+1>10)) {
            n[1]++
            if((!(currmap[n[0]][n[1]]=='p'))&&(!(currmap[n[0]][n[1]]=='w'))&&(!(currmap[n[0]][n[1]]=='t'))&&(!(currmap[n[0]][n[1]]=='i'))&&(!(currmap[n[0]][n[1]]=='e'))&&(!(currmap[n[0]][n[1]]=='s'))&&(!(currmap[n[0]][n[1]]=='v'))&&(!(currmap[n[0]][n[1]]=='k'))&&(!(currmap[n[0]][n[1]]=='g'))&&(!(currmap[n[0]][n[1]]=='f'))&&(!((currmap[n[0]][n[1]]=='c')&&hasgun))&&(!(currmap[n[0]][n[1]]=='~'))&&(!(currmap[n[0]][n[1]]=='='))){
              currmap[i[0]][i[1]] = '.'
              currmap[n[0]][n[1]] = 'p'
              hasmoved = true;
            }
            n[1]--
          }
        }
        hasmoved = true;
      }
    });
    updatetable(currmap)
  }
  
  function moveguard() {
    if(haskey||hasgun) {
      c = getguardcoords()
      c.forEach(function(i){
        n = JSON.parse(JSON.stringify(i))
        hasmoved = false
        while(!hasmoved){
          d = Math.ceil(Math.random()*4)
          if(!(n[0]-1<0)) {
            if(currmap[n[0]-1][n[1]]=='c'){
              d = 1
            }
          }
          if(!(n[0]+1>4)) {
            if(currmap[n[0]+1][n[1]]=='c'){
              d = 2
            }
          }
          if(!(n[1]-1<0)) {
            if(currmap[n[0]][n[1]-1]=='c'){
              d = 3
            }
          }
          if(!(n[1]+1>10)) {
            if(currmap[n[0]][n[1]+1]=='c'){
              d = 4
            }
          }
          if(d==1) { 
            if(!(i[0]-1<0)) {
              n[0]--
              if((!(currmap[n[0]][n[1]]=='p'))&&(!(currmap[n[0]][n[1]]=='w'))&&(!(currmap[n[0]][n[1]]=='t'))&&(!(currmap[n[0]][n[1]]=='i'))&&(!(currmap[n[0]][n[1]]=='e'))&&(!(currmap[n[0]][n[1]]=='s'))&&(!(currmap[n[0]][n[1]]=='v'))&&(!(currmap[n[0]][n[1]]=='k'))&&(!(currmap[n[0]][n[1]]=='g'))&&(!(currmap[n[0]][n[1]]=='~'))){
                currmap[i[0]][i[1]] = '.'
                currmap[n[0]][n[1]] = 'g'
                hasmoved = true;
              }
              n[0]++
            }
          }
          if(d==2) { 
            if(!(i[0]+1>4)) {
              n[0]++
              if((!(currmap[n[0]][n[1]]=='p'))&&(!(currmap[n[0]][n[1]]=='w'))&&(!(currmap[n[0]][n[1]]=='t'))&&(!(currmap[n[0]][n[1]]=='i'))&&(!(currmap[n[0]][n[1]]=='e'))&&(!(currmap[n[0]][n[1]]=='s'))&&(!(currmap[n[0]][n[1]]=='v'))&&(!(currmap[n[0]][n[1]]=='k'))&&(!(currmap[n[0]][n[1]]=='g'))&&(!(currmap[n[0]][n[1]]=='~'))){
                currmap[i[0]][i[1]] = '.'
                currmap[n[0]][n[1]] = 'g'
                hasmoved = true;
              }
              n[0]--
            }
          }
          if(d==3) { 
            if(!(i[1]-1<0)) {
              n[1]--
              if((!(currmap[n[0]][n[1]]=='p'))&&(!(currmap[n[0]][n[1]]=='w'))&&(!(currmap[n[0]][n[1]]=='t'))&&(!(currmap[n[0]][n[1]]=='i'))&&(!(currmap[n[0]][n[1]]=='e'))&&(!(currmap[n[0]][n[1]]=='s'))&&(!(currmap[n[0]][n[1]]=='v'))&&(!(currmap[n[0]][n[1]]=='k'))&&(!(currmap[n[0]][n[1]]=='g'))&&(!(currmap[n[0]][n[1]]=='~'))){
                currmap[i[0]][i[1]] = '.'
                currmap[n[0]][n[1]] = 'g'
                hasmoved = true;
              }
              n[1]++
            }
          }
          if(d==4) { 
            if(!(i[1]+1>10)) {
              n[1]++
              if((!(currmap[n[0]][n[1]]=='p'))&&(!(currmap[n[0]][n[1]]=='w'))&&(!(currmap[n[0]][n[1]]=='t'))&&(!(currmap[n[0]][n[1]]=='i'))&&(!(currmap[n[0]][n[1]]=='e'))&&(!(currmap[n[0]][n[1]]=='s'))&&(!(currmap[n[0]][n[1]]=='v'))&&(!(currmap[n[0]][n[1]]=='k'))&&(!(currmap[n[0]][n[1]]=='g'))&&(!(currmap[n[0]][n[1]]=='~'))){
                currmap[i[0]][i[1]] = '.'
                currmap[n[0]][n[1]] = 'g'
                hasmoved = true;
              }
              n[1]--
            }
          }
          hasmoved = true;
        }
      });
      updatetable(currmap)
    }
  }
  
  function moveinfector(){
    c = getinfectcoords()
    c.forEach(function(i){
      n = JSON.parse(JSON.stringify(i))
      hasmoved = false
      while(!hasmoved){
        d = Math.ceil(Math.random()*4)
        if(d==1) { 
          if(!(i[0]-1<0)) {
            n[0]--
            if((!(currmap[n[0]][n[1]]=='p'))&&(!(currmap[n[0]][n[1]]=='w'))&&(!(currmap[n[0]][n[1]]=='t'))&&(!(currmap[n[0]][n[1]]=='i'))&&(!(currmap[n[0]][n[1]]=='e'))&&(!(currmap[n[0]][n[1]]=='s'))&&(!(currmap[n[0]][n[1]]=='c'&&hassantizer()))&&(!(currmap[n[0]][n[1]]=='v'))&&(!(currmap[n[0]][n[1]]=='k'))&&(!(currmap[n[0]][n[1]]=='g'))&&(!(currmap[n[0]][n[1]]=='f'))&&(!(currmap[n[0]][n[1]]=='~'))&&(!(currmap[n[0]][n[1]]=='='))){
              currmap[i[0]][i[1]] = '#'
              currmap[n[0]][n[1]] = 'i'
              hasmoved = true;
            }
            n[0]++
          }
        }
        if(d==2) { 
          if(!(i[0]+1>4)) {
            n[0]++
            if((!(currmap[n[0]][n[1]]=='p'))&&(!(currmap[n[0]][n[1]]=='w'))&&(!(currmap[n[0]][n[1]]=='t'))&&(!(currmap[n[0]][n[1]]=='i'))&&(!(currmap[n[0]][n[1]]=='e'))&&(!(currmap[n[0]][n[1]]=='s'))&&(!(currmap[n[0]][n[1]]=='c'&&hassantizer()))&&(!(currmap[n[0]][n[1]]=='v'))&&(!(currmap[n[0]][n[1]]=='k'))&&(!(currmap[n[0]][n[1]]=='g'))&&(!(currmap[n[0]][n[1]]=='f'))&&(!(currmap[n[0]][n[1]]=='~'))&&(!(currmap[n[0]][n[1]]=='='))){
              currmap[i[0]][i[1]] = '#'
              currmap[n[0]][n[1]] = 'i'
              hasmoved = true;
            }
            n[0]--
          }
        }
        if(d==3) { 
          if(!(i[1]-1<0)) {
            n[1]--
            if((!(currmap[n[0]][n[1]]=='p'))&&(!(currmap[n[0]][n[1]]=='w'))&&(!(currmap[n[0]][n[1]]=='t'))&&(!(currmap[n[0]][n[1]]=='i'))&&(!(currmap[n[0]][n[1]]=='e'))&&(!(currmap[n[0]][n[1]]=='s'))&&(!(currmap[n[0]][n[1]]=='c'&&hassantizer()))&&(!(currmap[n[0]][n[1]]=='v'))&&(!(currmap[n[0]][n[1]]=='k'))&&(!(currmap[n[0]][n[1]]=='g'))&&(!(currmap[n[0]][n[1]]=='f'))&&(!(currmap[n[0]][n[1]]=='~'))&&(!(currmap[n[0]][n[1]]=='='))){
              currmap[i[0]][i[1]] = '#'
              currmap[n[0]][n[1]] = 'i'
              hasmoved = true;
            }
            n[1]++
          }
        }
        if(d==4) { 
          if(!(i[1]+1>10)) {
            n[1]++
            if((!(currmap[n[0]][n[1]]=='p'))&&(!(currmap[n[0]][n[1]]=='w'))&&(!(currmap[n[0]][n[1]]=='t'))&&(!(currmap[n[0]][n[1]]=='i'))&&(!(currmap[n[0]][n[1]]=='e'))&&(!(currmap[n[0]][n[1]]=='s'))&&(!(currmap[n[0]][n[1]]=='c'&&hassantizer()))&&(!(currmap[n[0]][n[1]]=='v'))&&(!(currmap[n[0]][n[1]]=='k'))&&(!(currmap[n[0]][n[1]]=='g'))&&(!(currmap[n[0]][n[1]]=='f'))&&(!(currmap[n[0]][n[1]]=='~'))&&(!(currmap[n[0]][n[1]]=='='))){
              currmap[i[0]][i[1]] = '#'
              currmap[n[0]][n[1]] = 'i'
              hasmoved = true;
            }
            n[1]--
          }
        }
        hasmoved = true;
      }
    });
    updatetable(currmap)
  }
  
  function movefire(){
    c = getfirecoords()
    c.forEach(function(i){
      n = JSON.parse(JSON.stringify(i))
      hasmoved = false
      while(!hasmoved){
        d = Math.ceil(Math.random()*4)
        if(d==1) { 
          if(!(i[0]-1<0)) {
            n[0]--
            if((!(currmap[n[0]][n[1]]=='w'))&&(!(currmap[n[0]][n[1]]=='e'))&&(!(currmap[n[0]][n[1]]=='c'&&hasexting()))&&(!(currmap[n[0]][n[1]]=='v'))&&(!(currmap[n[0]][n[1]]=='k'))&&(!(currmap[n[0]][n[1]]=='g'))&&(!(currmap[n[0]][n[1]]=='f')&&(!(currmap[n[0]][n[1]]=='s')))&&(!(currmap[n[0]][n[1]]=='='))){
              if(currmap[n[0]][n[1]]=='t'){
                currmap[n[0]][n[1]] = 'f'
              }
              currmap[n[0]][n[1]] = 'f'
              hasmoved = true;
            }
            n[0]++
          }
        }
        if(d==2) { 
          if(!(i[0]+1>4)) {
            n[0]++
            if((!(currmap[n[0]][n[1]]=='w'))&&(!(currmap[n[0]][n[1]]=='e'))&&(!(currmap[n[0]][n[1]]=='c'&&hasexting()))&&(!(currmap[n[0]][n[1]]=='v'))&&(!(currmap[n[0]][n[1]]=='k'))&&(!(currmap[n[0]][n[1]]=='g'))&&(!(currmap[n[0]][n[1]]=='f')&&(!(currmap[n[0]][n[1]]=='s')))&&(!(currmap[n[0]][n[1]]=='='))){
              if(currmap[n[0]][n[1]]=='t'){
                currmap[n[0]][n[1]] = 'f'
              }
              currmap[n[0]][n[1]] = 'f'
              hasmoved = true;
            }
            n[0]--
          }
        }
        if(d==3) { 
          if(!(i[1]-1<0)) {
            n[1]--
            if((!(currmap[n[0]][n[1]]=='w'))&&(!(currmap[n[0]][n[1]]=='e'))&&(!(currmap[n[0]][n[1]]=='c'&&hasexting()))&&(!(currmap[n[0]][n[1]]=='v'))&&(!(currmap[n[0]][n[1]]=='k'))&&(!(currmap[n[0]][n[1]]=='g'))&&(!(currmap[n[0]][n[1]]=='f')&&(!(currmap[n[0]][n[1]]=='s')))&&(!(currmap[n[0]][n[1]]=='='))){
              if(currmap[n[0]][n[1]]=='t'){
                currmap[n[0]][n[1]] = 'f'
              }
              currmap[n[0]][n[1]] = 'f'
              hasmoved = true;
            }
            n[1]++
          }
        }
        if(d==4) { 
          if(!(i[1]+1>10)) {
            n[1]++
            if((!(currmap[n[0]][n[1]]=='w'))&&(!(currmap[n[0]][n[1]]=='e'))&&(!(currmap[n[0]][n[1]]=='c'&&hasexting()))&&(!(currmap[n[0]][n[1]]=='v'))&&(!(currmap[n[0]][n[1]]=='k'))&&(!(currmap[n[0]][n[1]]=='g'))&&(!(currmap[n[0]][n[1]]=='f')&&(!(currmap[n[0]][n[1]]=='s')))&&(!(currmap[n[0]][n[1]]=='='))){
              if(currmap[n[0]][n[1]]=='t'){
                currmap[n[0]][n[1]] = 'f'
              }
              currmap[n[0]][n[1]] = 'f'
              hasmoved = true;
            }
            n[1]--
          }
        }
        hasmoved = true;
      }
    });
    updatetable(currmap)
  }
  
  function changedir(dir){
    direction = dir
  }
  
  function getdirection(e){
    if(!hasstarted) {
      removeoverlay()
      dir = ''
      cmoveint = setInterval(moveplayer, pspeed*speed)
      pmoveint = setInterval(movepeople, 900*speed)
      imoveint = setInterval(moveinfector, 1100*speed)
      fmoveint = setInterval(movefire, 1400*speed)
      gmoveint = setInterval(moveguard, 500*speed)
      hasstarted = true;
    }
    if(e.keyCode==87||e.keyCode==38){
      d = 'w'
    }else if(e.keyCode==83||e.keyCode==40){
      d = 's'
    }else if(e.keyCode==65||e.keyCode==37){
      d = 'a'
    }else if(e.keyCode==68||e.keyCode==39){
      d = 'd'
    }else {
      return false
    }
    changedir(d)
  }
  
  document.addEventListener("keydown", getdirection)
  
  window.onload = (function(){
    loadmap(currlev)
  })